description: >
  Setup pip.conf file

parameters:
  username:
    type: env_var_name
    default: "USERNAME"
    description: "Username for jfrog artifactory"
  password:
    type: env_var_name
    default: "PASSWORD"
    description: "Password for jfrog artifactory"
steps:
  # - run:
  #     environment:
  #       PARAM_USERNAME: <<parameters.username>>
  #       PARAM_PASSWORD: <<parameters.password>>
  #     name: Create custom pip.conf file
  #     command: <<include(scripts/pip.sh)>>
  # - run:
  #     name: testing var
  #     command: echo $USERNAME and $PASSWORD
  - run:
      name: Create custom pip.conf file
      command: |
        echo "Generating pip.conf file..."
        mkdir -p /home/circleci/.config/pip
        echo "[global]" > /home/circleci/.config/pip/pip.conf
        echo "index-url = https://${<<parameters.username>>}:${<<parameters.password>>}@fluence.jfrog.io/artifactory/api/pypi/fluence-pypi/simple" >> /home/circleci/.config/pip/pip.conf
        echo "Read pip.conf file"
        cat /home/circleci/.config/pip/pip.conf
